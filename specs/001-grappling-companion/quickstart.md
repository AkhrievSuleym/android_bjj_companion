# Quickstart Guide: Grappling Companion

**Feature**: Grappling Companion
**Date**: 2026-01-28
**Phase**: 1 (Design & Contracts)

## Purpose

This guide helps developers set up the development environment and run the Grappling Companion Android app locally.

## Prerequisites

### Required Software

| Software | Minimum Version | Purpose |
|----------|----------------|---------|
| Android Studio | Hedgehog (2023.1.1) or later | IDE for Android development |
| JDK | 17 | Required by Android Gradle Plugin 8.x |
| Android SDK | API 34 (Android 14) | Compile SDK |
| Git | 2.x | Version control |

### Recommended Hardware

- **RAM**: 16GB minimum (Android Studio + emulator)
- **Storage**: 10GB free space (SDK + dependencies)
- **CPU**: Multi-core processor for emulator performance

## Initial Setup

### 1. Clone Repository

```bash
git clone <repository-url>
cd BJJCompanion
```

### 2. Checkout Feature Branch

```bash
git checkout 001-grappling-companion
```

### 3. Obtain USDA API Key

1. Visit: https://fdc.nal.usda.gov/api-key-signup.html
2. Fill out the signup form:
   - **Name**: Your name
   - **Email**: Your email
   - **Organization**: Your company/personal (e.g., "Personal project")
3. Submit form
4. Check email for API key (delivered instantly)

### 4. Configure API Key

Create `local.properties` file in project root (if it doesn't exist):

```bash
touch local.properties
```

Add your USDA API key to `local.properties`:

```properties
# USDA FoodData Central API Key
USDA_API_KEY=your_actual_api_key_here

# Android SDK location (usually auto-generated by Android Studio)
sdk.dir=/Users/username/Library/Android/sdk
```

**Important**: `local.properties` is in `.gitignore` and should **never** be committed to version control.

### 5. Install Android SDK Components

Open Android Studio → **Tools → SDK Manager**, ensure these are installed:

**SDK Platforms**:
- Android 14.0 (API 34) - Compile target
- Android 8.0 (API 26) - Minimum supported version

**SDK Tools**:
- Android SDK Build-Tools 34.0.0
- Android Emulator
- Android SDK Platform-Tools

### 6. Sync Gradle

Open project in Android Studio:

1. Android Studio → **File → Open** → Select `BJJCompanion` folder
2. Wait for Gradle sync to complete (first sync downloads all dependencies)
3. If sync fails, check:
   - JDK 17 is selected (**File → Project Structure → SDK Location**)
   - `local.properties` has `USDA_API_KEY` configured
   - Internet connection is active (for dependency downloads)

## Running the App

### Option 1: Run on Emulator

#### Create Emulator (First Time Only)

1. Android Studio → **Tools → Device Manager**
2. Click **Create Device**
3. Select hardware: **Pixel 6** (recommended)
4. Select system image: **API 34 (Android 14.0)**
   - Choose **x86_64** ABI for Intel/AMD CPUs
   - Choose **arm64-v8a** for Apple Silicon Macs
5. Click **Finish**

#### Launch App

1. Select emulator from device dropdown (top toolbar)
2. Click **Run** button (green triangle) or press `Shift + F10` (Windows/Linux) / `Ctrl + R` (Mac)
3. Wait for build and installation
4. App launches automatically

**Expected Behavior**:
- First launch: Onboarding screens (welcome + profile setup)
- Subsequent launches: Dashboard screen

### Option 2: Run on Physical Device

#### Enable Developer Options (on device)

1. **Settings → About Phone → Tap "Build Number" 7 times**
2. **Settings → System → Developer Options**
3. Enable **USB Debugging**
4. Enable **Install via USB** (if available)

#### Connect and Run

1. Connect device via USB cable
2. Accept "Allow USB debugging" prompt on device
3. Select your device from dropdown in Android Studio
4. Click **Run** button

**Troubleshooting**:
- Device not detected? Check USB cable supports data transfer (not charge-only)
- Install Google USB Driver (Windows): **SDK Manager → SDK Tools → Google USB Driver**

## Project Structure Overview

```
app/
├── build.gradle.kts              # App module dependencies
├── src/
│   ├── main/
│   │   ├── java/com/example/grapplingcompanion/
│   │   │   ├── GrapplingApp.kt    # Application class (Hilt setup)
│   │   │   ├── MainActivity.kt     # Single Activity (Compose)
│   │   │   ├── data/               # Data layer (Room, Retrofit, Repositories)
│   │   │   ├── domain/             # Domain layer (Models, UseCases, Interfaces)
│   │   │   ├── presentation/       # UI layer (Compose, ViewModels)
│   │   │   └── di/                 # Dependency Injection (Hilt modules)
│   │   ├── res/                    # Resources (strings, etc.)
│   │   └── AndroidManifest.xml
│   ├── test/                       # Unit tests
│   └── androidTest/                # Instrumented tests
└── local.properties                # API keys (not committed)
```

## Development Workflow

### 1. Create Feature Branch

```bash
git checkout -b feature/T0XX-description
```

### 2. Make Changes

- Follow Clean Architecture (data/domain/presentation layers)
- Follow constitution naming conventions
- Keep functions under 30 lines
- Add KDoc for public APIs

### 3. Run Tests

**Unit Tests**:
```bash
./gradlew test
```

**Android Instrumented Tests**:
```bash
./gradlew connectedAndroidTest
```

### 4. Lint Check

```bash
./gradlew lint
```

### 5. Commit Changes

```bash
git add .
git commit -m "T0XX: Brief description"
```

Follow commit format from constitution: `T0XX: Description`

## Common Tasks

### Add New Dependency

Edit `app/build.gradle.kts`:

```kotlin
dependencies {
    implementation("androidx.example:library:1.0.0")
}
```

Then sync Gradle: **File → Sync Project with Gradle Files**

### View Database (Debug Builds)

1. Run app on emulator
2. **View → Tool Windows → App Inspection**
3. Select **Database Inspector** tab
4. View tables: user_profile, weight_entries, food_logs, trainings, techniques

### Test API Integration

Use **UsdaFoodApi** mock or real API:

```kotlin
// In ViewModel or UseCase
val foods = searchFoodUseCase("chicken breast")
```

**Tip**: Add logging interceptor to see network requests:

```kotlin
// NetworkModule.kt (already configured in debug builds)
val loggingInterceptor = HttpLoggingInterceptor().apply {
    level = HttpLoggingInterceptor.Level.BODY
}
```

Check Logcat for request/response logs.

### Change Theme (Light/Dark)

App respects system theme by default. To force a theme:

1. Run app
2. Navigate to **Settings** screen
3. Toggle **Dark Theme** switch
4. Theme changes immediately across entire app

## Troubleshooting

### Build Fails: "API key not found"

**Problem**: `local.properties` missing `USDA_API_KEY`

**Solution**:
1. Ensure `local.properties` exists in project root
2. Add line: `USDA_API_KEY=your_key_here`
3. Sync Gradle

### Emulator is Slow

**Solutions**:
- Use x86_64 emulator images (faster than ARM on Intel/AMD CPUs)
- Allocate more RAM: **Device Manager → Edit Device → Advanced → RAM: 4096 MB**
- Enable hardware acceleration: **Tools → SDK Manager → SDK Tools → Intel x86 Emulator Accelerator (HAXM)**
- Close other apps to free RAM

### Gradle Sync Fails

**Common Causes**:
1. **Internet connection**: Check network
2. **JDK version**: Ensure JDK 17 is selected (**File → Project Structure → SDK Location**)
3. **Corrupted cache**: **File → Invalidate Caches** → Restart

### App Crashes on Launch

**Debug Steps**:
1. Check **Logcat** for stack trace
2. Common issues:
   - Room migration errors: Uninstall app and reinstall (clears database)
   - Hilt DI errors: Check if `@HiltAndroidApp` is on Application class
   - Missing permissions: Check `AndroidManifest.xml`

### Food Search Returns No Results

**Check**:
1. Internet connection (API requires network)
2. API key is valid (check Logcat for 401 errors)
3. Search query is valid (minimum 2 characters)
4. USDA API is online: https://fdc.nal.usda.gov/

## Useful Commands

### Clean Build

```bash
./gradlew clean
./gradlew build
```

### Generate APK

```bash
./gradlew assembleDebug
```

Output: `app/build/outputs/apk/debug/app-debug.apk`

### Install APK on Device

```bash
./gradlew installDebug
```

### View Build Variants

Android Studio: **Build → Select Build Variant**
- **debug**: Development build (logging, debugging enabled)
- **release**: Production build (ProGuard enabled, no logging)

## Next Steps

### After Setup

1. **Explore Code**: Start with `MainActivity.kt` and `NavGraph.kt` to understand navigation
2. **Run App**: Test all features (onboarding, dashboard, weight tracking, etc.)
3. **Review Architecture**: Understand data flow (Repository → UseCase → ViewModel → Compose)
4. **Read Documentation**:
   - [data-model.md](./data-model.md) - Database schema and entities
   - [contracts/usda-api.md](./contracts/usda-api.md) - API integration details
   - [research.md](./research.md) - Technical decisions and rationale

### Ready to Implement?

Proceed to task breakdown:
```bash
# Generate tasks from spec and plan
/speckit.tasks
```

This will create `tasks.md` with actionable implementation steps organized by user story.

## Support

### Documentation

- **Feature Spec**: [spec.md](./spec.md)
- **Implementation Plan**: [plan.md](./plan.md)
- **Data Model**: [data-model.md](./data-model.md)
- **API Contract**: [contracts/usda-api.md](./contracts/usda-api.md)
- **Research**: [research.md](./research.md)

### External Resources

- **Jetpack Compose**: https://developer.android.com/jetpack/compose
- **Room Database**: https://developer.android.com/training/data-storage/room
- **Hilt DI**: https://dagger.dev/hilt/
- **Retrofit**: https://square.github.io/retrofit/
- **USDA API**: https://fdc.nal.usda.gov/api-guide.html

### Getting Help

- Check **Logcat** for error logs
- Review constitution for coding standards
- Ask team members (if applicable)
